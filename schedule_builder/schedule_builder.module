<?php

/**
 * @file
 * Schedule Builder module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function schedule_builder_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    case 'help.page.schedule_builder':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('The Schedule Builder module allows sitebuilders to place a block on pages containing event listings. The module attaches JavaScript that extracts event data from the page HTML, allows users to select events via checkboxes, and download selected events as ICS calendar files.') . '</p>';
      $output .= '<h3>' . t('Usage') . '</h3>';
      $output .= '<p>' . t('Place the Schedule Builder block on a page containing event listings. Configure the block settings to map CSS selectors to standard iCal event properties (title/summary, start/end times, description, location, and link). The module will automatically attach checkboxes to event items and enable ICS download functionality.') . '</p>';
      return $output;

    default:
  }
}

/**
 * Implements hook_theme().
 */
function schedule_builder_theme($existing, $type, $theme, $path) {
  return [
    'schedule_builder_block' => [
      'variables' => [
        'block_id' => NULL,
        'download_button_label' => NULL,
        'download_button_extra_classes' => NULL,
        'enable_selection_filter' => FALSE,
        'enable_select_actions' => FALSE,
        'filter_extra_classes' => NULL,
        'select_all_button_extra_classes' => NULL,
        'deselect_all_button_extra_classes' => NULL,
      ],
      'template' => 'schedule-builder-block',
    ],
  ];
}

/**
 * Implements hook_library_info_build().
 */
function schedule_builder_library_info_build() {
  $libraries = [];
  $libraries['schedule-builder'] = [
    'css' => [
      'theme' => [
        'css/schedule-builder.css' => [],
      ],
    ],
    'js' => [
      'js/schedule-builder.js' => [],
    ],
    'dependencies' => [
      'core/drupal',
    ],
  ];
  return $libraries;
}

